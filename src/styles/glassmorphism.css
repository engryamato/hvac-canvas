/**
 * Glassmorphism Utility Classes
 * 
 * CSS utility classes for applying glassmorphism effects across the application.
 * Based on the three-tier glass system defined in design-tokens.ts
 * 
 * Usage:
 * - .glass-tier1: Primary UI (Sidebar, Bottom Bar)
 * - .glass-tier2: Floating Elements (Modals, Overlays)
 * - .glass-tier3: Interactive Controls (Buttons, Inputs)
 * - .glass-pdf-controls: PDF overlay controls
 * 
 * Accessibility:
 * - Respects prefers-reduced-transparency
 * - Respects prefers-reduced-motion
 * - Respects prefers-contrast: high
 * - Provides fallbacks for unsupported browsers
 */

/* ============================================
   Tier 1: Primary UI (Sidebar, Bottom Bar)
   ============================================ */

.glass-tier1 {
  background: rgba(255, 255, 255, 0.75);
  backdrop-filter: blur(12px) saturate(150%);
  -webkit-backdrop-filter: blur(12px) saturate(150%);
  border-color: rgba(226, 232, 240, 0.8);
  box-shadow: 0 4px 24px rgba(0, 0, 0, 0.08),
              0 1px 3px rgba(59, 130, 246, 0.05),
              inset 0 1px 0 rgba(255, 255, 255, 0.6),
              inset 0 -1px 0 rgba(0, 0, 0, 0.02);
  border: 1px solid rgba(255, 255, 255, 0.5);
  position: relative;
}

.glass-tier1::before {
  content: '';
  position: absolute;
  inset: 0;
  border-radius: inherit;
  padding: 1px;
  background: linear-gradient(135deg, rgba(255, 255, 255, 0.8) 0%, rgba(255, 255, 255, 0.2) 100%);
  -webkit-mask: linear-gradient(#fff 0 0) content-box, linear-gradient(#fff 0 0);
  -webkit-mask-composite: xor;
  mask-composite: exclude;
  pointer-events: none;
}

/* Sub surface for tier1 sections (e.g., headers) */
.glass-tier1-section {
  background: rgba(248, 250, 252, 0.9);
  backdrop-filter: blur(8px) saturate(140%);
  -webkit-backdrop-filter: blur(8px) saturate(140%);
  border-color: rgba(226, 232, 240, 0.7);
  box-shadow: inset 0 1px 0 rgba(255, 255, 255, 0.5);
  border: 1px solid rgba(255, 255, 255, 0.4);
}

/* ============================================
   Tier 2: Floating Elements (Modals, Overlays)
   ============================================ */

.glass-tier2 {
  background: rgba(255, 255, 255, 0.85);
  backdrop-filter: blur(10px) saturate(160%);
  -webkit-backdrop-filter: blur(10px) saturate(160%);
  border-color: rgba(226, 232, 240, 0.9);
  box-shadow: 
    0 8px 32px rgba(0, 0, 0, 0.12),
    0 2px 8px rgba(0, 0, 0, 0.08),
    0 0 0 1px rgba(255, 255, 255, 0.5),
    inset 0 1px 0 rgba(255, 255, 255, 0.7),
    inset 0 -1px 0 rgba(0, 0, 0, 0.03);
  border: 1px solid rgba(255, 255, 255, 0.6);
  position: relative;
}

.glass-tier2::before {
  content: '';
  position: absolute;
  inset: 0;
  border-radius: inherit;
  padding: 1px;
  background: linear-gradient(135deg, rgba(255, 255, 255, 0.9) 0%, rgba(255, 255, 255, 0.3) 100%);
  -webkit-mask: linear-gradient(#fff 0 0) content-box, linear-gradient(#fff 0 0);
  -webkit-mask-composite: xor;
  mask-composite: exclude;
  pointer-events: none;
}

/* ============================================
   Tier 3: Interactive Controls (Buttons, Inputs)
   ============================================ */

.glass-tier3 {
  background: rgba(255, 255, 255, 0.92);
  backdrop-filter: blur(6px) saturate(140%);
  -webkit-backdrop-filter: blur(6px) saturate(140%);
  border-color: rgba(203, 213, 225, 0.8);
  box-shadow: 0 2px 4px rgba(0, 0, 0, 0.06),
              inset 0 1px 0 rgba(255, 255, 255, 0.6);
  border: 1px solid rgba(255, 255, 255, 0.5);
  transition: all 250ms cubic-bezier(0.4, 0, 0.2, 1);
}

/* ============================================
   Special: PDF Controls
   ============================================ */

.glass-pdf-controls {
  background: rgba(255, 255, 255, 0.9);
  backdrop-filter: blur(12px) saturate(150%);
  -webkit-backdrop-filter: blur(12px) saturate(150%);
  border-color: rgba(255, 255, 255, 0.4);
  box-shadow: 
    0 8px 24px rgba(0, 0, 0, 0.1),
    inset 0 1px 0 rgba(255, 255, 255, 0.6);
}

/* ============================================
   Browser Compatibility Fallbacks
   ============================================ */

/* Fallback for browsers that don't support backdrop-filter */
@supports not (backdrop-filter: blur(10px)) {
  .glass-tier1,
  .glass-tier1-section,
  .glass-tier2,
  .glass-tier3,
  .glass-pdf-controls {
    background: rgba(255, 255, 255, 0.98);
    backdrop-filter: none;
    -webkit-backdrop-filter: none;
  }
  
  /* Stronger shadow to compensate for lack of blur */
  .glass-tier1 {
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
  }
  
  .glass-tier2 {
    box-shadow: 0 8px 24px rgba(0, 0, 0, 0.18);
  }
}

/* ============================================
   Accessibility: High Contrast Mode
   ============================================ */

@media (prefers-contrast: high) {
  .glass-tier1,
  .glass-tier1-section,
  .glass-tier2,
  .glass-tier3,
  .glass-pdf-controls {
    /* Remove blur and transparency */
    background: #FFFFFF;
    backdrop-filter: none;
    -webkit-backdrop-filter: none;
    
    /* Stronger borders for definition */
    border: 2px solid #0F172A;
    border-color: #0F172A;
  }
}

/* ============================================
   Accessibility: Reduced Motion
   ============================================ */

@media (prefers-reduced-motion: reduce) {
  .glass-tier1,
  .glass-tier1-section,
  .glass-tier2,
  .glass-tier3,
  .glass-pdf-controls {
    /* Remove blur (can cause motion sickness) */
    background: rgba(255, 255, 255, 0.95);
    backdrop-filter: none;
    -webkit-backdrop-filter: none;
    
    /* Remove animations */
    transition: none;
  }
}

/* ============================================
   Accessibility: Reduced Transparency
   ============================================ */

@media (prefers-reduced-transparency: reduce) {
  .glass-tier1,
  .glass-tier1-section,
  .glass-tier2,
  .glass-tier3,
  .glass-pdf-controls {
    /* Remove transparency */
    background: #FFFFFF;
    backdrop-filter: none;
    -webkit-backdrop-filter: none;
  }
}

/* ============================================
   GPU Optimization
   ============================================ */

/* Force GPU compositing for glass elements */
.glass-tier1,
.glass-tier1-section,
.glass-tier2,
.glass-tier3,
.glass-pdf-controls {
  transform: translateZ(0);
  isolation: isolate;
}

/* Optimize draggable elements */
.glass-draggable {
  will-change: transform, backdrop-filter;
}

.glass-draggable:not(.dragging) {
  will-change: auto;
}

/* ============================================
   Hover States for Interactive Glass Elements
   ============================================ */

.glass-tier3-hover:hover {
  background: rgba(255, 255, 255, 0.98);
  border-color: rgba(203, 213, 225, 1);
  box-shadow: 0 4px 8px rgba(0, 0, 0, 0.08),
              inset 0 1px 0 rgba(255, 255, 255, 0.8);
  transform: translateY(-1px) scale(1.01);
}

.glass-tier3-hover:active {
  transform: translateY(0) scale(0.99);
}

/* ============================================
   Focus States for Glass Elements
   ============================================ */

.glass-focus:focus-visible {
  outline: 2px solid #3B82F6;
  outline-offset: 2px;
}

/* ============================================
   Dark Mode Support (Future)
   ============================================ */

@media (prefers-color-scheme: dark) {
  .glass-tier1 {
    background: rgba(15, 23, 42, 0.7);
    border-color: rgba(255, 255, 255, 0.1);
    backdrop-filter: blur(14px) saturate(130%);
    -webkit-backdrop-filter: blur(14px) saturate(130%);
  }

  .glass-tier1-section {
    background: rgba(30, 41, 59, 0.85);
    border-color: rgba(255, 255, 255, 0.12);
    backdrop-filter: blur(10px) saturate(130%);
    -webkit-backdrop-filter: blur(10px) saturate(130%);
  }
  
  .glass-tier2 {
    background: rgba(15, 23, 42, 0.8);
    border-color: rgba(255, 255, 255, 0.15);
    backdrop-filter: blur(12px) saturate(140%);
    -webkit-backdrop-filter: blur(12px) saturate(140%);
  }
  
  .glass-tier3 {
    background: rgba(15, 23, 42, 0.9);
    border-color: rgba(255, 255, 255, 0.2);
    backdrop-filter: blur(8px) saturate(120%);
    -webkit-backdrop-filter: blur(8px) saturate(120%);
  }
}
